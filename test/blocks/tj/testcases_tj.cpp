#include "testcases_tj.h"

namespace hydra::testcases::tj {

std::tuple<BondList, Couplings> tJchain(int n_sites, double t, double J) {

  BondList bondlist;
  Couplings couplings;
  couplings["T"] = t;
  couplings["J"] = J;
  for (int s = 0; s < n_sites; ++s) {
    bondlist << Bond("HOP", "T", {s, (s + 1) % n_sites});
    bondlist << Bond("HB", "J", {s, (s + 1) % n_sites});
  }
  return std::make_tuple(bondlist, couplings);
}

std::tuple<BondList, Couplings, lila::Vector<double>>
tJchain_fullspectrum_alps(int L) {

  BondList bonds;
  Couplings cpls;
  cpls["T"] = 1.0;
  cpls["J"] = 1.0;
  for (int s = 0; s < L; ++s) {
    bonds << Bond("HOP", "T", {s, (s + 1) % L});
    bonds << Bond("TJHB", "J", {s, (s + 1) % L});
  }
  lila::Vector<double> eigs;
  if (L == 3) {
    eigs = lila::Vector<double>(
        {-3.000000000000000000e+00, -2.000000000000000000e+00,
         -2.000000000000000000e+00, -1.500000000000000222e+00,
         -1.500000000000000000e+00, -1.499999999999999778e+00,
         -1.499999999999999778e+00, -1.000000000000000222e+00,
         -1.000000000000000222e+00, -1.000000000000000222e+00,
         -9.999999999999995559e-01, -9.999999999999995559e-01,
         -9.999999999999995559e-01, -4.440892098500626162e-16,
         0.000000000000000000e+00,  0.000000000000000000e+00,
         0.000000000000000000e+00,  0.000000000000000000e+00,
         0.000000000000000000e+00,  2.220446049250313081e-16,
         9.999999999999995559e-01,  9.999999999999995559e-01,
         1.000000000000000222e+00,  1.000000000000000222e+00,
         2.000000000000000000e+00,  2.000000000000000000e+00,
         2.000000000000000000e+00});
  } else if (L == 4) {
    eigs = lila::Vector<double>(
        {-3.372281323269014308e+00, -3.000000000000000000e+00,
         -2.802775637731994784e+00, -2.802775637731994784e+00,
         -2.802775637731994784e+00, -2.802775637731994340e+00,
         -2.500000000000000000e+00, -2.500000000000000000e+00,
         -2.000000000000000444e+00, -2.000000000000000444e+00,
         -2.000000000000000444e+00, -2.000000000000000444e+00,
         -2.000000000000000444e+00, -2.000000000000000000e+00,
         -2.000000000000000000e+00, -2.000000000000000000e+00,
         -2.000000000000000000e+00, -2.000000000000000000e+00,
         -2.000000000000000000e+00, -2.000000000000000000e+00,
         -2.000000000000000000e+00, -1.999999999999999778e+00,
         -1.999999999999999778e+00, -1.500000000000000000e+00,
         -1.500000000000000000e+00, -1.000000000000000000e+00,
         -1.000000000000000000e+00, -1.000000000000000000e+00,
         -1.000000000000000000e+00, -1.000000000000000000e+00,
         -1.000000000000000000e+00, -1.000000000000000000e+00,
         -1.000000000000000000e+00, -9.999999999999998890e-01,
         -9.999999999999998890e-01, -4.999999999999998335e-01,
         -4.999999999999998335e-01, -7.135599501605699864e-16,
         -3.673940397442059868e-16, -3.673940397442059868e-16,
         -3.673940397442059868e-16, -3.673940397442059868e-16,
         -2.952911727689802674e-16, -2.894200602996897038e-16,
         0.000000000000000000e+00,  0.000000000000000000e+00,
         0.000000000000000000e+00,  0.000000000000000000e+00,
         0.000000000000000000e+00,  0.000000000000000000e+00,
         0.000000000000000000e+00,  0.000000000000000000e+00,
         0.000000000000000000e+00,  0.000000000000000000e+00,
         1.110223024625156540e-16,  1.224646799147352961e-16,
         1.224646799147352961e-16,  1.224646799147352961e-16,
         1.224646799147352961e-16,  1.639932882561645220e-16,
         2.734977076943660831e-16,  4.063134752314966610e-16,
         5.000000000000001110e-01,  5.000000000000001110e-01,
         8.027756377319945624e-01,  8.027756377319947845e-01,
         8.027756377319948955e-01,  8.027756377319948955e-01,
         1.999999999999999334e+00,  1.999999999999999334e+00,
         2.000000000000000000e+00,  2.000000000000000000e+00,
         2.000000000000000000e+00,  2.000000000000000000e+00,
         2.000000000000000000e+00,  2.000000000000000444e+00,
         2.000000000000000444e+00,  2.000000000000000444e+00,
         2.000000000000000444e+00,  2.000000000000000444e+00,
         2.372281323269014752e+00});
  } else if (L == 5) {
    eigs = lila::Vector<double>({
        -3.907298272311668264e+00, -3.907298272311666487e+00,
        -3.693052960910438109e+00, -3.693052960910437221e+00,
        -3.693052960910437221e+00, -3.693052960910436333e+00,
        -3.581138830084189095e+00, -3.581138830084189095e+00,
        -3.581138830084189095e+00, -3.561552812808829849e+00,
        -3.236067977499789805e+00, -3.236067977499789805e+00,
        -3.236067977499789805e+00, -3.236067977499789805e+00,
        -3.118033988749894903e+00, -3.118033988749894903e+00,
        -3.118033988749894903e+00, -3.118033988749894903e+00,
        -3.045509296729518756e+00, -3.045509296729518312e+00,
        -3.045509296729516979e+00, -3.045509296729516535e+00,
        -2.829303974066772920e+00, -2.829303974066772476e+00,
        -2.829303974066772476e+00, -2.829303974066772032e+00,
        -2.829303974066771588e+00, -2.829303974066770255e+00,
        -2.822875655532295802e+00, -2.618033988749894903e+00,
        -2.618033988749894903e+00, -2.618033988749894903e+00,
        -2.618033988749894458e+00, -2.618033988749894458e+00,
        -2.618033988749894458e+00, -2.000000000000001776e+00,
        -2.000000000000001776e+00, -2.000000000000000888e+00,
        -2.000000000000000888e+00, -2.000000000000000444e+00,
        -2.000000000000000000e+00, -2.000000000000000000e+00,
        -2.000000000000000000e+00, -2.000000000000000000e+00,
        -2.000000000000000000e+00, -2.000000000000000000e+00,
        -2.000000000000000000e+00, -1.999999999999999778e+00,
        -1.999999999999999778e+00, -1.999999999999999778e+00,
        -1.999999999999999112e+00, -1.952675411443192344e+00,
        -1.952675411443190123e+00, -1.889303840153442993e+00,
        -1.889303840153442771e+00, -1.889303840153442549e+00,
        -1.889303840153442327e+00, -1.850781059358215019e+00,
        -1.850781059358211911e+00, -1.809016994374947673e+00,
        -1.809016994374947451e+00, -1.809016994374947451e+00,
        -1.809016994374947451e+00, -1.809016994374947229e+00,
        -1.809016994374947229e+00, -1.809016994374947229e+00,
        -1.809016994374947229e+00, -1.772222895765618755e+00,
        -1.772222895765618089e+00, -1.618033988749894903e+00,
        -1.618033988749894903e+00, -1.618033988749894903e+00,
        -1.618033988749894903e+00, -1.618033988749894458e+00,
        -1.618033988749894458e+00, -1.618033988749894458e+00,
        -1.618033988749894014e+00, -1.618033988749894014e+00,
        -1.618033988749893570e+00, -1.455886780102867650e+00,
        -1.455886780102866318e+00, -1.280776406404415368e+00,
        -1.280776406404415368e+00, -1.236067977499790693e+00,
        -1.236067977499789583e+00, -1.236067977499789583e+00,
        -1.096296493180666465e+00, -1.096296493180665799e+00,
        -1.096296493180665133e+00, -1.096296493180665133e+00,
        -1.047324588556808989e+00, -1.047324588556808100e+00,
        -1.000000000000000666e+00, -1.000000000000000444e+00,
        -1.000000000000000222e+00, -1.000000000000000000e+00,
        -1.000000000000000000e+00, -1.000000000000000000e+00,
        -1.000000000000000000e+00, -1.000000000000000000e+00,
        -1.000000000000000000e+00, -1.000000000000000000e+00,
        -1.000000000000000000e+00, -9.999999999999997780e-01,
        -9.999999999999997780e-01, -9.999999999999997780e-01,
        -9.999999999999997780e-01, -9.999999999999997780e-01,
        -9.999999999999996669e-01, -9.999999999999993339e-01,
        -9.999999999999993339e-01, -8.819660112501055416e-01,
        -8.819660112501053195e-01, -8.819660112501052085e-01,
        -8.819660112501049865e-01, -6.909830056250531038e-01,
        -6.909830056250526598e-01, -6.909830056250526598e-01,
        -6.909830056250526598e-01, -6.909830056250526598e-01,
        -6.909830056250523267e-01, -6.909830056250523267e-01,
        -6.909830056250519936e-01, -6.180339887498953466e-01,
        -6.180339887498953466e-01, -6.180339887498946805e-01,
        -6.180339887498946805e-01, -4.188611699158105717e-01,
        -4.188611699158099611e-01, -4.188611699158099611e-01,
        -3.819660112501059301e-01, -3.819660112501059301e-01,
        -3.819660112501055971e-01, -3.819660112501050975e-01,
        -3.819660112501047644e-01, -3.819660112501047644e-01,
        -3.664215497114276521e-01, -3.664215497114270970e-01,
        -3.664215497114268749e-01, -3.664215497114265974e-01,
        -1.771243444677048917e-01, -1.621472086470287510e-01,
        -1.621472086470273632e-01, -1.013980634478428011e-01,
        -1.013980634478427179e-01, -1.013980634478425791e-01,
        -1.013980634478423709e-01, -1.013980634478421905e-01,
        -1.013980634478420934e-01, -7.134456953968647264e-02,
        -7.134456953968623671e-02, -7.134456953968602855e-02,
        -7.134456953968550119e-02, 0.000000000000000000e+00,
        0.000000000000000000e+00,  0.000000000000000000e+00,
        0.000000000000000000e+00,  0.000000000000000000e+00,
        0.000000000000000000e+00,  0.000000000000000000e+00,
        3.819660112501047089e-01,  3.819660112501049865e-01,
        3.819660112501049865e-01,  3.819660112501050420e-01,
        3.819660112501052085e-01,  3.819660112501052085e-01,
        3.819660112501057636e-01,  3.819660112501059301e-01,
        5.377370150526344927e-01,  5.377370150526344927e-01,
        5.377370150526347148e-01,  5.377370150526348258e-01,
        5.615528128088295157e-01,  6.180339887498945695e-01,
        6.180339887498946805e-01,  6.180339887498946805e-01,
        6.180339887498950135e-01,  6.180339887498950135e-01,
        6.180339887498952356e-01,  6.180339887498953466e-01,
        6.180339887498953466e-01,  6.180339887498955687e-01,
        6.180339887498959017e-01,  7.194320521977372040e-01,
        7.194320521977374261e-01,  7.194320521977375371e-01,
        7.194320521977375371e-01,  7.194320521977376481e-01,
        7.194320521977379812e-01,  7.807764064044150354e-01,
        7.807764064044150354e-01,  9.072982723116669312e-01,
        9.072982723116670423e-01,  9.999999999999988898e-01,
        9.999999999999996669e-01,  9.999999999999997780e-01,
        9.999999999999997780e-01,  1.000000000000000000e+00,
        1.000000000000000000e+00,  1.000000000000000444e+00,
        1.000000000000000444e+00,  1.000000000000000444e+00,
        1.000000000000000666e+00,  1.000000000000000666e+00,
        1.000000000000000888e+00,  1.211269985316877129e+00,
        1.211269985316877129e+00,  1.211269985316877351e+00,
        1.211269985316877573e+00,  1.211269985316877573e+00,
        1.211269985316877573e+00,  1.236067977499789583e+00,
        1.236067977499789583e+00,  1.236067977499789583e+00,
        1.236067977499790027e+00,  1.350781059358212133e+00,
        1.350781059358212355e+00,  1.618033988749894458e+00,
        1.618033988749894458e+00,  1.618033988749894903e+00,
        1.618033988749894903e+00,  1.999999999999999112e+00,
        2.000000000000000000e+00,  2.000000000000000000e+00,
        2.000000000000000000e+00,  2.000000000000000000e+00,
        2.390256884515513658e+00,  2.390256884515514102e+00,
        2.618033988749894458e+00,  2.618033988749894458e+00,
        2.618033988749894458e+00,  2.618033988749894458e+00,
        2.618033988749894458e+00,  2.618033988749894458e+00,
        2.618033988749894903e+00,  2.618033988749895347e+00,
        2.624191695172540140e+00,  2.624191695172540584e+00,
        2.624191695172541028e+00,  2.624191695172541916e+00,
        3.236067977499789805e+00,  3.236067977499789805e+00,
        3.236067977499789805e+00,
    });
  } else if (L == 6) {
    eigs = lila::Vector<double>(
        {-4.718848588389245258e+00, -4.718848588389242593e+00,
         -4.659018389481651923e+00, -4.659018389481650146e+00,
         -4.659018389481649258e+00, -4.529220480852993447e+00,
         -4.529220480852993447e+00, -4.529220480852991670e+00,
         -4.529220480852991670e+00, -4.302775637731993896e+00,
         -4.273268092055898748e+00, -4.273268092055898748e+00,
         -4.273268092055898748e+00, -4.273268092055898748e+00,
         -4.121390705499550222e+00, -4.043633691625603710e+00,
         -4.043633691625602822e+00, -4.043633691625601934e+00,
         -4.043633691625601934e+00, -4.043633691625600157e+00,
         -4.043633691625598381e+00, -4.000000000000000000e+00,
         -4.000000000000000000e+00, -3.999999999999998668e+00,
         -3.999999999999998668e+00, -3.944808754632456171e+00,
         -3.904584740115982111e+00, -3.904584740115982111e+00,
         -3.904584740115976338e+00, -3.904584740115976338e+00,
         -3.875591819415423966e+00, -3.875591819415423966e+00,
         -3.673697782601942130e+00, -3.647348530536128397e+00,
         -3.647348530536128397e+00, -3.647348530536127953e+00,
         -3.647348530536127065e+00, -3.618033988749894903e+00,
         -3.618033988749894903e+00, -3.618033988749894014e+00,
         -3.427050983124844130e+00, -3.427050983124844130e+00,
         -3.427050983124841022e+00, -3.427050983124839689e+00,
         -3.365730596579042277e+00, -3.365730596579042277e+00,
         -3.365730596579041389e+00, -3.365730596579041389e+00,
         -3.365730596579041389e+00, -3.365730596579040945e+00,
         -3.365730596579040057e+00, -3.365730596579039613e+00,
         -3.209671551095003128e+00, -3.209671551095000019e+00,
         -3.154949692197403621e+00, -3.154949692197403177e+00,
         -3.154949692197400957e+00, -3.129492040622247728e+00,
         -3.129492040622245952e+00, -3.129492040622245508e+00,
         -3.129492040622244620e+00, -3.129492040622243731e+00,
         -3.129492040622243731e+00, -3.057394515707376748e+00,
         -3.057394515707376303e+00, -3.040629361949072518e+00,
         -3.040629361949072074e+00, -3.040629361949070741e+00,
         -3.000000000000001776e+00, -3.000000000000000888e+00,
         -3.000000000000000888e+00, -3.000000000000000888e+00,
         -3.000000000000000888e+00, -3.000000000000000444e+00,
         -3.000000000000000000e+00, -3.000000000000000000e+00,
         -3.000000000000000000e+00, -3.000000000000000000e+00,
         -2.999999999999999556e+00, -2.999999999999999556e+00,
         -2.999999999999999112e+00, -2.999999999999999112e+00,
         -2.999999999999999112e+00, -2.999999999999998668e+00,
         -2.999999999999995559e+00, -2.992998918900551697e+00,
         -2.992998918900550809e+00, -2.992998918900550809e+00,
         -2.992998918900550809e+00, -2.992998918900550365e+00,
         -2.992998918900549477e+00, -2.822875655532295358e+00,
         -2.822875655532295358e+00, -2.802775637731995229e+00,
         -2.802775637731994784e+00, -2.780776406404415368e+00,
         -2.780776406404415368e+00, -2.780776406404414924e+00,
         -2.780776406404414924e+00, -2.780776406404414480e+00,
         -2.780776406404413592e+00, -2.770690632574555945e+00,
         -2.770690632574555057e+00, -2.770690632574555057e+00,
         -2.770690632574555057e+00, -2.729378538715642399e+00,
         -2.729378538715641955e+00, -2.639548698143149963e+00,
         -2.639548698143149075e+00, -2.639548698143149075e+00,
         -2.639548698143148631e+00, -2.616274632102561171e+00,
         -2.616274632102558506e+00, -2.592376513845756847e+00,
         -2.592376513845756403e+00, -2.592376513845755959e+00,
         -2.592376513845754182e+00, -2.571998697327452010e+00,
         -2.571998697327452010e+00, -2.571998697327451566e+00,
         -2.571998697327451566e+00, -2.571998697327451566e+00,
         -2.571998697327450678e+00, -2.571998697327450678e+00,
         -2.571998697327450678e+00, -2.500000000000001776e+00,
         -2.500000000000001776e+00, -2.500000000000001332e+00,
         -2.500000000000001332e+00, -2.500000000000001332e+00,
         -2.500000000000000444e+00, -2.500000000000000000e+00,
         -2.500000000000000000e+00, -2.500000000000000000e+00,
         -2.500000000000000000e+00, -2.500000000000000000e+00,
         -2.499999999999999556e+00, -2.499999999999999112e+00,
         -2.499999999999999112e+00, -2.499999999999999112e+00,
         -2.499999999999999112e+00, -2.372692311899931905e+00,
         -2.372692311899931461e+00, -2.372692311899930573e+00,
         -2.372692311899929685e+00, -2.372692311899929241e+00,
         -2.372692311899928796e+00, -2.335853267144799350e+00,
         -2.302775637731994340e+00, -2.302775637731993008e+00,
         -2.282492086378670404e+00, -2.282492086378669516e+00,
         -2.260214025764832435e+00, -2.260214025764831547e+00,
         -2.260214025764830659e+00, -2.260214025764830659e+00,
         -2.186140661634507598e+00, -2.186140661634506266e+00,
         -2.186140661634505822e+00, -2.000000000000003553e+00,
         -2.000000000000002665e+00, -2.000000000000001332e+00,
         -2.000000000000000888e+00, -2.000000000000000444e+00,
         -2.000000000000000444e+00, -2.000000000000000444e+00,
         -2.000000000000000444e+00, -2.000000000000000444e+00,
         -2.000000000000000444e+00, -2.000000000000000000e+00,
         -2.000000000000000000e+00, -2.000000000000000000e+00,
         -2.000000000000000000e+00, -2.000000000000000000e+00,
         -2.000000000000000000e+00, -2.000000000000000000e+00,
         -2.000000000000000000e+00, -2.000000000000000000e+00,
         -2.000000000000000000e+00, -2.000000000000000000e+00,
         -2.000000000000000000e+00, -2.000000000000000000e+00,
         -2.000000000000000000e+00, -2.000000000000000000e+00,
         -2.000000000000000000e+00, -1.999999999999999778e+00,
         -1.999999999999999778e+00, -1.999999999999999778e+00,
         -1.999999999999999778e+00, -1.999999999999999778e+00,
         -1.999999999999999556e+00, -1.999999999999999556e+00,
         -1.999999999999999556e+00, -1.999999999999999334e+00,
         -1.999999999999999334e+00, -1.999999999999999334e+00,
         -1.999999999999999112e+00, -1.999999999999999112e+00,
         -1.999999999999998668e+00, -1.999999999999998224e+00,
         -1.999999999999998224e+00, -1.999999999999996891e+00,
         -1.954475764744234123e+00, -1.954475764744233457e+00,
         -1.954475764744232347e+00, -1.954475764744231681e+00,
         -1.954475764744231459e+00, -1.954475764744231236e+00,
         -1.954475764744231014e+00, -1.954475764744230792e+00,
         -1.939752675878360311e+00, -1.939752675878359645e+00,
         -1.939752675878359200e+00, -1.741805810271954469e+00,
         -1.741805810271953581e+00, -1.715593279993965270e+00,
         -1.715593279993963938e+00, -1.696375432928910909e+00,
         -1.696375432928910687e+00, -1.696375432928910021e+00,
         -1.696375432928909799e+00, -1.696375432928908467e+00,
         -1.696375432928908467e+00, -1.696375432928908245e+00,
         -1.696375432928907578e+00, -1.659517919595428603e+00,
         -1.659517919595425939e+00, -1.659517919595425495e+00,
         -1.652985625170195760e+00, -1.543945817538950882e+00,
         -1.543945817538950660e+00, -1.543945817538949994e+00,
         -1.543945817538949772e+00, -1.543945817538949106e+00,
         -1.543945817538948662e+00, -1.501718334831788848e+00,
         -1.501718334831788848e+00, -1.501718334831788848e+00,
         -1.501718334831788848e+00, -1.501718334831788404e+00,
         -1.501718334831788182e+00, -1.500000000000000666e+00,
         -1.500000000000000444e+00, -1.500000000000000444e+00,
         -1.500000000000000222e+00, -1.500000000000000000e+00,
         -1.500000000000000000e+00, -1.499999999999999778e+00,
         -1.499999999999999556e+00, -1.499999999999999556e+00,
         -1.499999999999999556e+00, -1.499999999999999334e+00,
         -1.499999999999999334e+00, -1.499999999999999112e+00,
         -1.433836606168212846e+00, -1.433836606168211514e+00,
         -1.433836606168209293e+00, -1.433836606168209071e+00,
         -1.381966011250105542e+00, -1.381966011250105542e+00,
         -1.381966011250104875e+00, -1.309016994374947229e+00,
         -1.309016994374947007e+00, -1.309016994374946785e+00,
         -1.309016994374946785e+00, -1.296749155012716592e+00,
         -1.296749155012716592e+00, -1.296749155012715926e+00,
         -1.296749155012715038e+00, -1.270120205628136656e+00,
         -1.270120205628136434e+00, -1.270120205628136212e+00,
         -1.212261568424558345e+00, -1.212261568424557900e+00,
         -1.212261568424557012e+00, -1.212261568424556790e+00,
         -1.151387818865997170e+00, -1.151387818865997170e+00,
         -1.151387818865996726e+00, -1.151387818865996726e+00,
         -1.141411931654399359e+00, -1.141411931654398471e+00,
         -1.124539956431930721e+00, -1.124539956431929832e+00,
         -1.124539956431928500e+00, -1.124539956431927834e+00,
         -1.124539956431927834e+00, -1.124539956431926724e+00,
         -1.124539956431925614e+00, -1.124539956431924725e+00,
         -1.063059756408450740e+00, -1.063059756408449630e+00,
         -1.000000000000002887e+00, -1.000000000000002665e+00,
         -1.000000000000002665e+00, -1.000000000000002442e+00,
         -1.000000000000002442e+00, -1.000000000000001776e+00,
         -1.000000000000001554e+00, -1.000000000000001110e+00,
         -1.000000000000001110e+00, -1.000000000000001110e+00,
         -1.000000000000001110e+00, -1.000000000000001110e+00,
         -1.000000000000000222e+00, -1.000000000000000222e+00,
         -1.000000000000000222e+00, -1.000000000000000222e+00,
         -1.000000000000000222e+00, -1.000000000000000222e+00,
         -1.000000000000000222e+00, -1.000000000000000000e+00,
         -1.000000000000000000e+00, -1.000000000000000000e+00,
         -1.000000000000000000e+00, -1.000000000000000000e+00,
         -1.000000000000000000e+00, -1.000000000000000000e+00,
         -1.000000000000000000e+00, -9.999999999999998890e-01,
         -9.999999999999998890e-01, -9.999999999999998890e-01,
         -9.999999999999997780e-01, -9.999999999999996669e-01,
         -9.999999999999996669e-01, -9.999999999999995559e-01,
         -9.999999999999993339e-01, -9.999999999999993339e-01,
         -9.999999999999993339e-01, -9.999999999999993339e-01,
         -9.999999999999993339e-01, -9.999999999999993339e-01,
         -9.999999999999993339e-01, -9.999999999999992228e-01,
         -9.999999999999992228e-01, -9.999999999999988898e-01,
         -9.999999999999987788e-01, -9.999999999999987788e-01,
         -9.999999999999987788e-01, -9.999999999999987788e-01,
         -9.999999999999987788e-01, -9.999999999999985567e-01,
         -9.999999999999985567e-01, -9.999999999999985567e-01,
         -9.999999999999985567e-01, -9.999999999999984457e-01,
         -9.999999999999983347e-01, -9.999999999999982236e-01,
         -9.999999999999982236e-01, -9.999999999999980016e-01,
         -9.999999999999978906e-01, -9.999999999999978906e-01,
         -9.999999999999958922e-01, -8.761916662884380314e-01,
         -8.761916662884368101e-01, -8.761916662884368101e-01,
         -8.761916662884358109e-01, -8.008314410579505660e-01,
         -8.008314410579503440e-01, -7.944927255527800547e-01,
         -7.192235935955850756e-01, -7.192235935955849646e-01,
         -7.192235935955848536e-01, -7.192235935955847426e-01,
         -7.192235935955844095e-01, -7.192235935955841875e-01,
         -7.024860041181855141e-01, -7.024860041181839598e-01,
         -6.972243622680056596e-01, -6.970344862534286756e-01,
         -6.970344862534285646e-01, -6.970344862534280095e-01,
         -6.970344862534280095e-01, -6.802094629610827559e-01,
         -6.802094629610825338e-01, -6.802094629610823118e-01,
         -6.802094629610823118e-01, -6.802094629610819787e-01,
         -6.802094629610814236e-01, -6.543335068936673160e-01,
         -6.180339887498952356e-01, -6.180339887498947915e-01,
         -6.113154554591215817e-01, -6.113154554591214707e-01,
         -6.113154554591212486e-01, -6.010638336795661729e-01,
         -6.010638336795655068e-01, -6.010638336795653958e-01,
         -6.010638336795653958e-01, -6.010638336795651737e-01,
         -6.010638336795648407e-01, -5.849208892673074534e-01,
         -5.849208892673072313e-01, -5.849208892673058990e-01,
         -5.849208892673050109e-01, -5.784721438307652841e-01,
         -5.784721438307651731e-01, -5.784721438307649510e-01,
         -5.784721438307649510e-01, -5.000000000000017764e-01,
         -5.000000000000013323e-01, -5.000000000000011102e-01,
         -5.000000000000011102e-01, -5.000000000000006661e-01,
         -5.000000000000006661e-01, -5.000000000000004441e-01,
         -5.000000000000004441e-01, -5.000000000000001110e-01,
         -5.000000000000000000e-01, -4.999999999999997780e-01,
         -4.999999999999997224e-01, -4.999999999999996114e-01,
         -4.999999999999993894e-01, -4.999999999999993894e-01,
         -4.999999999999992784e-01, -4.999999999999988898e-01,
         -4.999999999999985567e-01, -3.784702766558871723e-01,
         -3.660254037844387631e-01, -3.660254037844367647e-01,
         -1.909830056250530206e-01, -1.909830056250530206e-01,
         -1.909830056250527985e-01, -1.909830056250527708e-01,
         -1.771243444677051970e-01, -1.771243444677038648e-01,
         -1.586882464835153439e-01, -1.586882464835152329e-01,
         -1.586882464835136786e-01, -1.586882464835129014e-01,
         -1.268470797498301161e-01, -1.268470797498293667e-01,
         -1.268470797498292557e-01, -1.268470797498291724e-01,
         -1.016630913877278886e-01, -1.016630913877275694e-01,
         -1.016630913877272363e-01, -1.016630913877264175e-01,
         -1.016630913877262510e-01, -1.016630913877260983e-01,
         -7.294901687515813193e-02, -7.294901687515789601e-02,
         -7.294901687515789601e-02, -7.294901687515763233e-02,
         -2.394134672806448856e-15, -1.054711873393898713e-15,
         -8.393491019875685633e-16, -7.988401606873196670e-16,
         -7.035060257584244750e-16, -7.035060257584242778e-16,
         -5.360295540768333922e-16, -5.360295540768333922e-16,
         -5.162211442474597552e-16, -3.530162273612802437e-16,
         -2.247986171407448816e-16, -2.045673362976726152e-16,
         -2.014369054868349967e-16, -1.608242375776552155e-16,
         -1.269311111249954204e-16, -3.129919280553698552e-17,
         -2.198380378617713124e-17, -2.760550251275205008e-18,
         -1.941337383942333740e-31, 0.000000000000000000e+00,
         0.000000000000000000e+00,  0.000000000000000000e+00,
         0.000000000000000000e+00,  0.000000000000000000e+00,
         0.000000000000000000e+00,  0.000000000000000000e+00,
         0.000000000000000000e+00,  0.000000000000000000e+00,
         0.000000000000000000e+00,  0.000000000000000000e+00,
         2.465190328815661892e-32,  2.584443936238652089e-17,
         3.394100373975150199e-17,  6.400666176798177453e-17,
         6.400666176798177453e-17,  6.819304718169445047e-17,
         8.829371687394313324e-17,  9.454242944073598665e-17,
         9.454242944073598665e-17,  1.270524534002064436e-16,
         1.270524534002064436e-16,  1.327063459122257427e-16,
         1.942890293094023946e-16,  2.027855456977511942e-16,
         2.027855456977511942e-16,  3.051339660825868205e-16,
         3.051339660825868205e-16,  3.375427188076996649e-16,
         3.512815038853034366e-16,  4.041985014704114489e-16,
         5.860193142121108038e-16,  5.912735749300942909e-16,
         7.035060257584244750e-16,  7.035060257584244750e-16,
         7.778700287923261851e-16,  8.465450562766818621e-16,
         1.525975925163061042e-15,  6.769912511718144399e-02,
         6.769912511718155501e-02,  6.769912511718188808e-02,
         6.769912511718258197e-02,  6.769912511718290116e-02,
         6.769912511718323422e-02,  2.393014801852336448e-01,
         2.706906325745546682e-01,  2.706906325745546682e-01,
         2.706906325745550568e-01,  2.706906325745552788e-01,
         2.806054652253132109e-01,  2.806054652253137660e-01,
         2.806054652253140436e-01,  2.806054652253140436e-01,
         3.157953061665452199e-01,  3.157953061665457750e-01,
         3.157953061665458860e-01,  3.157953061665459971e-01,
         3.157953061665459971e-01,  3.157953061665461081e-01,
         3.157953061665462191e-01,  3.157953061665463301e-01,
         4.999999999999993894e-01,  4.999999999999996114e-01,
         4.999999999999999445e-01,  5.000000000000002220e-01,
         6.403076882201788056e-01,  6.403076882201798048e-01,
         6.403076882201799158e-01,  6.403076882201805820e-01,
         6.403076882201808040e-01,  6.403076882201814701e-01,
         6.513878188659971702e-01,  6.513878188659971702e-01,
         6.513878188659975033e-01,  6.513878188659975033e-01,
         6.861406616345055998e-01,  6.861406616345071541e-01,
         6.861406616345072651e-01,  8.027756377319944514e-01,
         8.027756377319946735e-01,  8.204468888862831433e-01,
         8.204468888862853637e-01,  8.204468888862856968e-01,
         8.589057203788658112e-01,  8.589057203788660333e-01,
         8.589057203788664774e-01,  8.589057203788666994e-01,
         8.589057203788666994e-01,  8.589057203788669215e-01,
         9.030869822535392277e-01,  9.030869822535402269e-01,
         9.030869822535404490e-01,  9.030869822535412261e-01,
         9.525788240898135362e-01,  9.525788240898135362e-01,
         9.525788240898135362e-01,  9.525788240898135362e-01,
         9.525788240898136472e-01,  9.525788240898139803e-01,
         9.525788240898142023e-01,  9.525788240898144243e-01,
         9.999999999999960032e-01,  9.999999999999964473e-01,
         9.999999999999973355e-01,  9.999999999999977796e-01,
         9.999999999999977796e-01,  9.999999999999977796e-01,
         9.999999999999977796e-01,  9.999999999999982236e-01,
         9.999999999999985567e-01,  9.999999999999985567e-01,
         9.999999999999986677e-01,  9.999999999999991118e-01,
         9.999999999999992228e-01,  9.999999999999993339e-01,
         9.999999999999993339e-01,  9.999999999999993339e-01,
         9.999999999999994449e-01,  9.999999999999994449e-01,
         9.999999999999995559e-01,  9.999999999999996669e-01,
         9.999999999999996669e-01,  9.999999999999996669e-01,
         9.999999999999997780e-01,  9.999999999999998890e-01,
         9.999999999999998890e-01,  9.999999999999998890e-01,
         9.999999999999998890e-01,  1.000000000000000000e+00,
         1.000000000000000000e+00,  1.000000000000000222e+00,
         1.000000000000000222e+00,  1.000000000000000222e+00,
         1.000000000000000444e+00,  1.000000000000000444e+00,
         1.000000000000000888e+00,  1.000000000000000888e+00,
         1.000000000000000888e+00,  1.000000000000000888e+00,
         1.000000000000001110e+00,  1.000000000000001332e+00,
         1.000000000000001332e+00,  1.000000000000001332e+00,
         1.000000000000001332e+00,  1.000000000000001776e+00,
         1.000000000000002220e+00,  1.000000000000002665e+00,
         1.000000000000002665e+00,  1.000000000000002665e+00,
         1.085263370510425318e+00,  1.085263370510425318e+00,
         1.093082165420402152e+00,  1.093082165420403928e+00,
         1.140718043143993832e+00,  1.140718043143994276e+00,
         1.162552820262288122e+00,  1.162552820262288344e+00,
         1.162552820262288344e+00,  1.162552820262288789e+00,
         1.289591954872401969e+00,  1.289591954872402413e+00,
         1.289591954872402635e+00,  1.289591954872403079e+00,
         1.292438295124092473e+00,  1.292438295124092695e+00,
         1.302775637731994784e+00,  1.302775637731995229e+00,
         1.366025403784439707e+00,  1.366025403784439707e+00,
         1.383217741926351607e+00,  1.383217741926351829e+00,
         1.444746317755201348e+00,  1.444746317755201570e+00,
         1.444746317755201570e+00,  1.444746317755201570e+00,
         1.444746317755201792e+00,  1.444746317755202236e+00,
         1.444746317755202458e+00,  1.444746317755202458e+00,
         1.507485573228670717e+00,  1.507485573228671605e+00,
         1.507485573228671827e+00,  1.507485573228672271e+00,
         1.507485573228672493e+00,  1.507485573228672937e+00,
         1.618033988749893348e+00,  1.618033988749897789e+00,
         1.660120339183549509e+00,  1.660120339183552396e+00,
         1.814467611792828450e+00,  1.814467611792828894e+00,
         1.814467611792830004e+00,  1.999999999999998224e+00,
         1.999999999999999112e+00,  1.999999999999999112e+00,
         1.999999999999999556e+00,  1.999999999999999778e+00,
         1.999999999999999778e+00,  1.999999999999999778e+00,
         2.000000000000000000e+00,  2.000000000000000000e+00,
         2.000000000000000000e+00,  2.000000000000000000e+00,
         2.000000000000000000e+00,  2.000000000000000000e+00,
         2.000000000000000000e+00,  2.000000000000000000e+00,
         2.000000000000000000e+00,  2.000000000000000000e+00,
         2.000000000000000000e+00,  2.000000000000000000e+00,
         2.000000000000000000e+00,  2.000000000000000000e+00,
         2.000000000000000000e+00,  2.000000000000000000e+00,
         2.000000000000000444e+00,  2.000000000000000444e+00,
         2.000000000000000444e+00,  2.000000000000000444e+00,
         2.000000000000000444e+00,  2.000000000000000888e+00,
         2.000000000000000888e+00,  2.000000000000001332e+00,
         2.000000000000002665e+00,  2.151944817408193877e+00,
         2.151944817408194321e+00,  2.151944817408194766e+00,
         2.548444382101858974e+00,  2.548444382101859418e+00,
         2.548444382101862082e+00,  2.754018409978336468e+00,
         2.754018409978336468e+00,  2.754018409978336912e+00,
         2.754018409978337356e+00,  2.893019396502539919e+00,
         2.893019396502539919e+00,  2.893019396502540364e+00,
         2.893019396502540364e+00,  2.893019396502540364e+00,
         2.893019396502541696e+00,  2.988699874470436946e+00,
         2.999999999999998224e+00,  2.999999999999998668e+00,
         2.999999999999999112e+00,  2.999999999999999112e+00,
         2.999999999999999112e+00,  3.000000000000000000e+00,
         3.000000000000000000e+00,  3.000000000000000000e+00,
         3.000000000000000000e+00,  3.000000000000000000e+00,
         3.000000000000000444e+00,  3.000000000000000888e+00,
         3.000000000000000888e+00,  3.000000000000001332e+00,
         3.000000000000001776e+00,  3.000000000000002665e+00,
         3.328031289495609446e+00,  3.421707290201617901e+00,
         3.421707290201618346e+00,  3.421707290201619678e+00,
         3.421707290201620122e+00,  3.999999999999999112e+00,
         4.000000000000000000e+00,  4.000000000000000000e+00,
         4.000000000000000000e+00});
  }
  return {bonds, cpls, eigs};
}

std::tuple<BondList, Couplings, lila::Vector<double>>
tj_square2x2_fullspectrum_alps() {
  BondList bondlist;
  Couplings couplings;
  couplings["T"] = 1.0;
  couplings["J"] = 1.0;
  bondlist << Bond("HOP", "T", {0, 1});
  bondlist << Bond("HOP", "T", {1, 0});
  bondlist << Bond("HOP", "T", {2, 3});
  bondlist << Bond("HOP", "T", {3, 2});
  bondlist << Bond("HOP", "T", {0, 2});
  bondlist << Bond("HOP", "T", {2, 0});
  bondlist << Bond("HOP", "T", {1, 3});
  bondlist << Bond("HOP", "T", {3, 1});
  bondlist << Bond("TJHB", "J", {0, 1});
  bondlist << Bond("TJHB", "J", {1, 0});
  bondlist << Bond("TJHB", "J", {2, 3});
  bondlist << Bond("TJHB", "J", {3, 2});
  bondlist << Bond("TJHB", "J", {0, 2});
  bondlist << Bond("TJHB", "J", {2, 0});
  bondlist << Bond("TJHB", "J", {1, 3});
  bondlist << Bond("TJHB", "J", {3, 1});
  auto eigs = lila::Vector<double>(
      {-6.744562646538028616e+00, -6.000000000000000000e+00,
       -5.605551275463989569e+00, -5.605551275463988681e+00,
       -5.605551275463988681e+00, -5.605551275463987793e+00,
       -5.000000000000001776e+00, -5.000000000000000000e+00,
       -4.000000000000000000e+00, -4.000000000000000000e+00,
       -4.000000000000000000e+00, -4.000000000000000000e+00,
       -4.000000000000000000e+00, -4.000000000000000000e+00,
       -4.000000000000000000e+00, -4.000000000000000000e+00,
       -4.000000000000000000e+00, -4.000000000000000000e+00,
       -4.000000000000000000e+00, -3.999999999999999112e+00,
       -3.999999999999999112e+00, -3.999999999999998668e+00,
       -3.999999999999997335e+00, -3.000000000000000444e+00,
       -2.999999999999999556e+00, -2.000000000000000000e+00,
       -2.000000000000000000e+00, -2.000000000000000000e+00,
       -2.000000000000000000e+00, -2.000000000000000000e+00,
       -2.000000000000000000e+00, -2.000000000000000000e+00,
       -2.000000000000000000e+00, -2.000000000000000000e+00,
       -1.999999999999999778e+00, -1.000000000000000666e+00,
       -9.999999999999993339e-01, -4.986988239733237738e-16,
       -3.463824224941973143e-16, -2.220446049250313081e-16,
       -2.189528850507527646e-47, 0.000000000000000000e+00,
       0.000000000000000000e+00,  0.000000000000000000e+00,
       0.000000000000000000e+00,  0.000000000000000000e+00,
       0.000000000000000000e+00,  0.000000000000000000e+00,
       0.000000000000000000e+00,  0.000000000000000000e+00,
       0.000000000000000000e+00,  0.000000000000000000e+00,
       0.000000000000000000e+00,  0.000000000000000000e+00,
       9.989175938846199659e-64,  1.094764425253762850e-47,
       1.149317380545422902e-31,  2.639405485626648673e-16,
       3.463824224941973143e-16,  6.704558904477481834e-16,
       7.486432941671353203e-16,  8.881784197001252323e-16,
       9.999999999999991118e-01,  1.000000000000000000e+00,
       1.605551275463988903e+00,  1.605551275463989569e+00,
       1.605551275463989569e+00,  1.605551275463990901e+00,
       3.999999999999998668e+00,  4.000000000000000000e+00,
       4.000000000000000000e+00,  4.000000000000000000e+00,
       4.000000000000000000e+00,  4.000000000000000000e+00,
       4.000000000000000000e+00,  4.000000000000000000e+00,
       4.000000000000000000e+00,  4.000000000000000000e+00,
       4.000000000000000888e+00,  4.000000000000000888e+00,
       4.744562646538030393e+00});
  return {bondlist, couplings, eigs};
}


std::tuple<BondList, Couplings> tj_alltoall(int n_sites)
{
  std::default_random_engine generator;
  std::normal_distribution<double> distribution(0., 1.);

  BondList bondlist;
  Couplings couplings;
  for (int s1=0; s1<n_sites; ++s1)
    for (int s2=s1+1; s2<n_sites; ++s2)
      {
	std::stringstream ss;
	ss << "T" << s1 << "_" << s2;
	std::string name = ss.str();
        double value = distribution(generator);
	bondlist << Bond("HOP", name, {s1, s2});
	couplings[name] = value;
      }
  for (int s1=0; s1<n_sites; ++s1)
    for (int s2=s1+1; s2<n_sites; ++s2)
      {
	std::stringstream ss;
	ss << "J" << s1 << "_" << s2;
	std::string name = ss.str();
        double value = distribution(generator);
	bondlist << Bond("HB", name, {s1, s2});
	couplings[name] = value;
      }
  return std::make_tuple(bondlist, couplings);
}
  
std::tuple<BondList, Couplings> tj_alltoall_complex(int n_sites) {
  std::default_random_engine generator;
  std::normal_distribution<double> distribution(0., 1.);

  BondList bondlist;
  Couplings couplings;
  for (int s1 = 0; s1 < n_sites; ++s1)
    for (int s2 = s1 + 1; s2 < n_sites; ++s2) {
      std::stringstream ss;
      ss << "T" << s1 << "_" << s2;
      std::string name = ss.str();
      complex value = complex(distribution(generator), distribution(generator));
      bondlist << Bond("HOP", name, {s1, s2});
      couplings[name] = value;
    }
  for (int s1 = 0; s1 < n_sites; ++s1)
    for (int s2 = s1 + 1; s2 < n_sites; ++s2) {
      std::stringstream ss;
      ss << "J" << s1 << "_" << s2;
      std::string name = ss.str();
      double value = distribution(generator);
      bondlist << Bond("HB", name, {s1, s2});
      couplings[name] = value;
    }
  return std::make_tuple(bondlist, couplings);
}

std::tuple<BondList, Couplings, lila::Vector<double>> randomAlltoAll4() {
  BondList bondlist;
  Couplings couplings;
  couplings["T01"] = 3;
  couplings["J01"] = -1;
  couplings["T02"] = 5;
  couplings["J02"] = -3;
  couplings["T03"] = -3;
  couplings["J03"] = -4;
  couplings["T12"] = -4;
  couplings["J12"] = 4;
  couplings["T13"] = 1;
  couplings["J13"] = 1;
  couplings["T23"] = -4;
  couplings["J23"] = 4;
  bondlist << Bond("HOP", "T01", {0, 1});
  bondlist << Bond("HOP", "T02", {0, 2});
  bondlist << Bond("HOP", "T03", {0, 3});
  bondlist << Bond("HOP", "T12", {1, 2});
  bondlist << Bond("HOP", "T13", {1, 3});
  bondlist << Bond("HOP", "T23", {2, 3});
  bondlist << Bond("HB", "J01", {0, 1});
  bondlist << Bond("HB", "J02", {0, 2});
  bondlist << Bond("HB", "J03", {0, 3});
  bondlist << Bond("HB", "J12", {1, 2});
  bondlist << Bond("HB", "J13", {1, 3});
  bondlist << Bond("HB", "J23", {2, 3});

  lila::Vector<double> eigs = {
      11.248037068163532,  11.248037068163532,  11.248037068163525,
      11.065227832307894,  11.065227832307894,  9.306675891741317,
      8.662882010346033,   8.657976760822836,   8.657976760822836,
      8.657976760822836,   8.657976760822834,   8.063532588075779,
      8.063532588075764,   6.481080152183720,   6.481080152183719,
      5.791677176221874,   5.791677176221870,   5.791677176221866,
      5.421909557114028,   5.421909557114025,   5.421909557114025,
      3.790737053062996,   3.790737053062993,   3.118890411464794,
      3.118890411464786,   2.958921205854569,   2.958921205854564,
      2.958921205854563,   2.958921205854562,   2.116741093804408,
      2.116741093804406,   1.929449471770335,   0.953137136205862,
      0.250000000000000,   0.250000000000000,   0.250000000000000,
      0.249999999999999,   0.249999999999997,   0.235484013369333,
      0.235484013369333,   0.235484013369333,   0.00000000000,
      -0.362599685623073,  -0.362599685623074,  -0.362599685623075,
      -1.349827627014560,  -1.437076270406664,  -1.437076270406664,
      -1.625660474823871,  -1.625660474823871,  -1.625660474823872,
      -2.429449471770339,  -2.877480421348348,  -2.877480421348353,
      -2.997539622795272,  -2.997539622795273,  -2.997539622795273,
      -2.997539622795274,  -4.416016701397999,  -4.416016701398001,
      -4.416016701398002,  -5.055974199575041,  -5.055974199575048,
      -5.075832683032555,  -5.075832683032559,  -5.075832683032563,
      -7.105004298762840,  -7.105004298762840,  -7.590841617892030,
      -8.119358343882125,  -8.119358343882126,  -8.119358343882128,
      -8.119358343882128,  -8.304942578192204,  -8.304942578192211,
      -10.732025793386637, -10.855731362614454, -10.855731362614462,
      -11.216998269991256, -11.216998269991262, -11.216998269991262};
  std::sort(eigs.begin(), eigs.end());
  return {bondlist, couplings, eigs};
}

std::tuple<BondList, Couplings, lila::Vector<double>> randomAlltoAll3() {
  BondList bondlist;
  Couplings couplings;
  couplings["T01"] = 1;
  couplings["J01"] = -2;
  couplings["T02"] = 0;
  couplings["J02"] = -1;
  couplings["T12"] = -5;
  couplings["J12"] = -3;
  bondlist << Bond("HOP", "T01", {0, 1});
  bondlist << Bond("HOP", "T02", {0, 2});
  bondlist << Bond("HOP", "T12", {1, 2});
  bondlist << Bond("HB", "J01", {0, 1});
  bondlist << Bond("HB", "J02", {0, 2});
  bondlist << Bond("HB", "J12", {1, 2});

  lila::Vector<double> eigs = {
      6.256066270684332,  5.099019513592784,  5.099019513592784,
      4.721070064265688,  4.721070064265687,  4.721070064265685,
      2.366025403784440,  2.366025403784439,  2.219929940881326,
      0.633974596215562,  0.633974596215561,  0.000000000000002,
      0.000000000000001,  0.00000000000000,   -0.740340833755520,
      -0.740340833755521, -0.740340833755522, -1.500000000000000,
      -1.500000000000000, -1.500000000000000, -1.500000000000002,
      -3.975996211565658, -5.099019513592784, -5.099019513592786,
      -5.480729230510166, -5.480729230510166, -5.480729230510167};
  std::sort(eigs.begin(), eigs.end());
  return {bondlist, couplings, eigs};
}

} // namespace hydra::testcases::tj
